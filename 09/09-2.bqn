in â† '0'-Ëœâ€¢GetLine@
disk â† inâ‰Ë˜Ëœ{ğ•©â†‘â¥Š(â†•ğ•©)â‰Ë˜ğ•©â¥ŠÂ¯1}â‰ in
# combine consecutive elements, remove 0 lengths
Combine â† {vâ€¿0ğ•Ša: a ;
           xsğ•ŠÂ¯1â€¿Â·: xs ; # strip Â¯1 from end
           vâ€¿lğ•Šwâ€¿k: {v=w ? vâˆ¾(k+l) ; (â‰vâ€¿l)âˆ¾(â‰wâ€¿k) } ; # Ë first call
           vâ€¿lğ•Ša: {vâ‰¡âŠ‘â¥Ša ? (lâŠ¸+)âŒ¾((0â€¿1)âŠ¸âŠ‘)a ; (â‰vâ€¿l)âˆ¾a}}
MoveFile â† {fğ•Ša:
  idxd â† aâˆ¾Ë˜â†•â‰ a
  vâ€¿lâ€¿i â† âŠ(f=âŠ)Ë˜âŠ¸/idxd
  holes â† {ğ•ŠÂ¯1â€¿sâ€¿Â·: sâ‰¥l ; 0}Ë˜âŠ¸/idxd
  {0=â‰ holes ? a ;
    Â·â€¿sâ€¿j â† âŠholes
    {i<j ? a ;
      CombineË (jâ†‘a)âˆ¾(vâ€¿l)âˆ¾(Â¯1â‹ˆs-l)âˆ¾((j+1)â†“Â¯1âŒ¾((iâ€¿0)âŠ¸âŠ‘)a) }}}
Checksum â† {+Â´Ã—Ë(â†•âˆ˜â‰ â‰(âŠ¢Ã—0âŠ¸â‰¤))/ËâŒ½â‰ğ•©}
Â·â€¿sln â† {ğ•Š nâ€¿a: (n-1)â€¿(n MoveFile a)}â€¢_while_{ğ•Š nâ€¿a: n>0}(âŒˆÂ´âŠË˜disk)â€¿disk
â€¢Show Checksum sln


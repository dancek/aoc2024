in â† â€¢FLines"input"
npc â† â¥Šâ†•â‰¢numpad â† >"789"â€¿"456"â€¿"123"â€¿" 0A"
kpc â† â¥Šâ†•â‰¢keypad â† >" ^A"â€¿"<v>"

Np â† {âŠ‘(â¥Šğ•©=numpad)/npc}
Kp â† {âŠ‘(â¥Šğ•©=keypad)/kpc}
_seq â† {yâ€¿x â† (aâ€¿bâ†ğ”½ğ•©) - câ€¿dâ†ğ”½ğ•¨
  s â† ((0âŒˆx)â¥Š'>') âˆ¾ ((0âŒˆy)â¥Š'v') âˆ¾ ((0âŒˆ-y)â¥Š'^') âˆ¾ ((0âŒˆ-x)â¥Š'<') âˆ¾ "A"
  f â† ((0âŒˆ-x)â¥Š'<') âˆ¾ ((0âŒˆy)â¥Š'v') âˆ¾ ((0âŒˆ-y)â¥Š'^') âˆ¾ ((0âŒˆx)â¥Š'>') âˆ¾ "A"
  t â† Â¬((y=0) âˆ¨ (x=0) âˆ¨ ((ğ•—=np)âˆ§(3=aâŒˆc)âˆ§0=bâŒŠd) âˆ¨ ((ğ•—=kp)âˆ§(0=aâŒŠc)âˆ§0=bâŒŠd))
  {t ? f; s} # safe or fast solution?
}
_pairwise â† {âˆ¾Â´ ğ”½Â¨ <Ë˜ 2â†•ğ•©}
# Solve â† {(â€¢ParseFloat Â¯1â†“ğ•©) Ã—â‰  ğ•¨âŠ¸KpDepth _pairwise "A"âˆ¾ğ•©}

ks â† 1â†“â¥Škeypad
kseqs â† 'A' Kp _seqÂ¨ks
CalcKpCost â† {costs ğ•Š seq: +Â´(ksâŠseq)âŠcosts}
KpNextCosts â† {ğ•©âˆ¾(Â¯1âŠğ•©)âŠ¸CalcKpCostÂ¨kseqs}
c0 â† â‰1â€¿1â€¿1â€¿1â€¿1
kpCosts â† KpNextCostsâŸ25 â‰1â€¿1â€¿1â€¿1â€¿1
NpCost â† {depth ğ•Š code:
  s â† Np _seqÂ´ _pairwise "A"âˆ¾code
  â€¢Show s
  â€¢Show c â† depthâŠkpCosts
  c CalcKpCost s}
â€¢Show ksâ‰kseqs
â€¢Show kpCosts
2 NpCost "179A"

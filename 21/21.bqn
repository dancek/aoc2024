in ← •FLines"input"
npc ← ⥊↕≢numpad ← >"789"‿"456"‿"123"‿" 0A"
kpc ← ⥊↕≢keypad ← >" ^A"‿"<v>"

Np ← {⊑(⥊𝕩=numpad)/npc}
Kp ← {⊑(⥊𝕩=keypad)/kpc}
_seqs ← {y‿x ← (a‿b←𝔽𝕩) - c‿d←𝔽𝕨
  s ← ((0⌈x)⥊'>') ∾ ((0⌈y)⥊'v') ∾ ((0⌈-y)⥊'^') ∾ ((0⌈-x)⥊'<') ∾ "A"
  f ← ((0⌈-x)⥊'<') ∾ ((0⌈y)⥊'v') ∾ ((0⌈-y)⥊'^') ∾ ((0⌈x)⥊'>') ∾ "A"
  t ← ¬((y=0) ∨ (x=0) ∨ ((𝕗=np)∧(3=a⌈c)∧0=b⌊d) ∨ ((𝕗=kp)∧(0=a⌊c)∧0=b⌊d))
  ⟨s⟩ ∾ {t ? ⟨f⟩; ⟨⟩} # safe or safe and fast solutions?
}
_full ← {⥊∾⌜´ 𝔽_seqs´¨ <˘ 2↕ "A"∾𝕩}
Solve ← {(•ParseFloat ¯1↓𝕩) × ⌊´≠¨∾Kp _full¨ ∾Kp _full¨ Np _full 𝕩}
•Show +´Solve¨in
